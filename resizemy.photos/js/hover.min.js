function createLink(){var e=document.createElement("a");e.innerHTML+="Crop/Resize",e.setAttribute("id","resizeMyPhoto"),e.setAttribute("target","_blank"),document.body.appendChild(e),cropperExtension.link=e}function setLinkVisibility(e){var t=cropperExtension.link,n=e?"block":"none";if(e){var i=getPosition(cropperExtension.curImage);t.style.top=i.top+10+"px",t.style.right=i.right+10+"px",t.href=chrome.extension.getURL("index.html#")+cropperExtension.curImage.src}t.style.display=n}function getPosition(e){var t=document.body.getBoundingClientRect(),n=e.getBoundingClientRect(),i=n.top-t.top;return{right:t.right-n.right,top:i}}function setLink(e){"IMG"===e.srcElement.nodeName&&e.srcElement!==cropperExtension.curImage&&e.srcElement.width>=150?(cropperExtension.curImage=e.srcElement,setLinkVisibility(!0)):"IMG"!==e.srcElement.nodeName&&e.srcElement!==cropperExtension.link&&(cropperExtension.curImage=null,setLinkVisibility(!1))}chrome.runtime.sendMessage({status:"getStatus"},function(e){"true"==e.status&&(createLink(),document.addEventListener("mousemove",setLink,!0))}),chrome.runtime.onMessage.addListener(function(e,t,n){"true"==e.status?(createLink(),document.addEventListener("mousemove",setLink,!0)):(document.body.removeChild(cropperExtension.link),document.removeEventListener("mousemove",setLink,!0))});var cropperExtension={};