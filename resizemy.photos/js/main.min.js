!function(e,t,a,o,n,i,c){e.GoogleAnalyticsObject=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date,i=t.createElement(a),c=t.getElementsByTagName(a)[0],i.async=1,i.src="https://www.google-analytics.com/analytics.js",c.parentNode.insertBefore(i,c)}(window,document,"script",0,"ga"),ga("create","UA-101979275-1","auto"),ga("set","checkProtocolTask",function(){}),ga("require","displayfeatures"),ga("send","pageview","/cropper.html"),window.onload=function(){"use strict";function e(e,t,a){g.innerHTML=e,m.innerHTML="Original size: "+t+"x"+a}function t(e,t){u.value=Math.round(t),p.value=Math.round(e)}function a(e,t){e&&e.classList.remove(t)}function o(e,t){e&&e.classList.add(t)}var n=window.Cropper,i=document.getElementById("img-container"),c=document.getElementById("prepareImage"),r=document.getElementById("custom"),d=document.getElementById("preset"),l=document.getElementById("preset-groups"),s=document.getElementById("download"),u=document.getElementById("dataHeight"),p=document.getElementById("dataWidth"),g=document.getElementById("file-name"),m=document.getElementById("file-size"),v=function(){var e=0;return function(t,a){clearTimeout(e),e=setTimeout(t,a)}}(),y={aspectRatio:16/9,zoomable:!1,checkCrossOrigin:!0,ready:function(e){console.log(e.type)},cropstart:function(e){console.log(e.type,e.detail.action)},cropmove:function(e){console.log(e.type,e.detail.action)},cropend:function(e){console.log(e.type,e.detail.action)},crop:function(e){e.detail;console.log(e.type)},zoom:function(e){console.log(e.type,e.detail.ratio)}},f=window.location.hash.substring(1),h=i.getElementsByTagName("img").item(0);if(f){h.src=f,ga("send","event","image","image loaded",f);var w=new XMLHttpRequest;w.open("GET",f,!0),w.onreadystatechange=function(){4==w.readyState&&new n(h,{ready:function(){b.replace(f)}})},w.send()}h.onload=function(){var a=h.getAttribute("src"),o=h.naturalWidth,n=h.naturalHeight;e(a,o,n),t(o,n)};var b=new n(h,y);l.onclick=function(e){var t=e||window.event,n=t.target||t.srcElement;if(""!==n.type){a($("#preset-groups >li.active-preset-category")[0],"active-preset-category");var i="#"+n.parentElement.className;o(n.parentElement,"active-preset-category"),a($("#standard >div.active-preset-category")[0],"active-preset-category"),o($(i)[0],"active-preset-category")}},r.onclick=function(e){o(this,"active-section"),a(d,"active-section")},d.onclick=function(e){o(this,"active-section"),a(r,"active-section")},r.oninput=function(e){var t,i=e||window.event,r=i.target||i.srcElement,d=document.getElementById("keep-ratio").checked;b&&void 0!==r.type&&("label"===r.tagName.toLowerCase()&&(r=r.querySelector("input")),d?("dataWidth"===r.id?u.value=Math.round(r.value*(h.naturalHeight/h.naturalWidth)):"dataHeight"===r.id&&(p.value=Math.round(r.value*(h.naturalWidth/h.naturalHeight))),t=b.getImageData(),y.aspectRatio=t.aspectRatio,y.top=0,y.left=0,y.autoCropArea=1):y.aspectRatio=Math.round(p.value/u.value),v(function(){o($("#custom-sizes input")[0],"active-item"),a($(".box.btn.active")[0],"active-item"),c.setAttribute("data-option",'{ "width": '+p.value+', "height": '+u.value+" }"),c.setAttribute("data-file-name","custom-"+p.value+"x"+u.value),ga("send","event","image","image cropped",'{ "width": '+p.value+', "height": '+u.value+" }"),r.disabled=!0,b.destroy(),b=new n(h,y),r.disabled=!1},1e3))},d.onchange=function(e){var t,n=e||window.event,i=n.target||n.srcElement;t={option:i.getAttribute("data-option")},b&&void 0!==i.type&&("label"===i.tagName.toLowerCase()&&(i=i.querySelector("input")),t.optionJson=JSON.parse(t.option),a($(".box.btn.active-item")[0],"active-item"),o(i.parentNode,"active-item"),a($("#custom-sizes input")[0],"active-item"),c.setAttribute("data-option",t.option),c.setAttribute("data-file-name",i.id+"-"+t.optionJson.width+"x"+t.optionJson.height),ga("send","event","image","image cropped",t.option),y.ready=function(){console.log("ready")},b.setAspectRatio(i.value))},s.onclick=function(e){var t,a,o=e||window.event,n=o.target||o.srcElement;if(b&&"getCroppedCanvas"===(a={method:n.getAttribute("data-method"),option:n.getAttribute("data-option"),fileName:n.getAttribute("data-file-name")}).method&&(a.optionJson=JSON.parse(a.option),a.fileName,t=b[a.method](a.optionJson))){cropedImageType=$('input[name="fileType"]:checked').val(),"image/jpeg"===cropedImageType?cropedImageName+=".jpg":cropedImageName+=".png";var i=$("<a>").attr("href",t.toDataURL(cropedImageType)).attr("download",cropedImageName).appendTo("body");i[0].click(),i.remove(),ga("send","event","image","image downloaded",a.option)}}};